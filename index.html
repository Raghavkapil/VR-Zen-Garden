<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Zen Garden VR</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
      
      #overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.95); color: white; z-index: 999;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        text-align: center;
      }
      .btn {
        background: #ff9ff3; color: #2d3436; padding: 20px 50px; font-size: 1.5rem;
        border: none; border-radius: 60px; margin-top: 30px; cursor: pointer; font-weight: bold;
        box-shadow: 0 0 30px #ff9ff3; transition: all 0.3s;
      }
      .btn:hover { transform: scale(1.1); }

      /* Responsive Info Panel - Top Right Corner */
      #info-panel {
        position: fixed;
        top: 20px; right: 20px;
        max-width: 380px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px;
        padding: 16px 20px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.4s ease;
        pointer-events: none;
        z-index: 100;
        font-size: clamp(14px, 2.5vw, 18px); /* Responsive text */
        line-height: 1.5;
      }
      #info-panel.show {
        opacity: 1;
        transform: translateY(0);
      }
      #info-title {
        font-weight: bold;
        margin-bottom: 6px;
        font-size: clamp(18px, 3vw, 24px);
        text-shadow: 0 2px 10px rgba(0,0,0,0.4);
      }
      #info-text {
        opacity: 0.9;
      }

      /* Day / Night text color */
      .day-text { color: #000000 !important; }
      .night-text { color: #ffffff !important; }
    </style>
  </head>
  <body>

    <div id="overlay">
      <h1>ZEN GARDEN</h1>
      <p>Stare at anything to learn its wisdom</p>
      <p>Stare at the Sun/Moon to change time</p>
      <button class="btn" onclick="document.getElementById('overlay').style.display='none'">ENTER PEACE</button>
    </div>

    <!-- Responsive Info Panel -->
    <div id="info-panel">
      <div id="info-title">Welcome</div>
      <div id="info-text">Look around and discover the soul of this garden...</div>
    </div>

    <a-scene garden-generator fog="type: exponential; color: #e0f7fa; density: 0.04" shadow="type: pcfsoft">
      
      <a-sky color="#81ecec"></a-sky>
      <a-plane rotation="-90 0 0" width="120" height="120" color="#f5f5dc" shadow="receive: true"></a-plane>

      <a-light type="ambient" intensity="0.5"></a-light>
      <a-light id="mainLight" type="directional" intensity="1" position="8 20 10" castShadow="true"></a-light>

      <!-- Sun/Moon -->
      <a-sphere id="sunmoon" class="clickable info-item" data-name="The Eternal Flame" data-desc="Giver of light and changer of time. One stare flips the world."
                position="0 10 -20" radius="2.2" color="#ff7675" shader="flat" atmosphere-control></a-sphere>

      <!-- Camera -->
      <a-entity position="0 1.6 0">
        <a-camera>
          <a-cursor color="#ff9ff3" fuse="true" raycaster="objects: .info-item"></a-cursor>
        </a-camera>
      </a-entity>

    </a-scene>

    <script>
      // === GARDEN GENERATOR ===
      AFRAME.registerComponent('garden-generator', {
        init: function () {
          const scene = this.el;

          // Trees - Now with proper info + perfect circle
          const treeNames = ["Sakura of Serenity", "Bonsai Master", "Whispering Pine", "Blossom Guardian", "Ancient Willow", "Lotus Tree", "Moonlit Cedar", "Dawn Cherry"];
          const treeDescs = [
            "Blooms only when your soul is calm.",
            "500 years old. Still shorter than your ego.",
            "Listens to your thoughts. Judges quietly.",
            "Protects the garden from bad vibes.",
            "Has seen empires rise and fall. Unimpressed.",
            "Rooted in water, growing in dreams.",
            "Glows faintly under moonlight.",
            "Wakes up early to catch the sunrise."
          ];
          for (let i = 0; i < 16; i++) {
            let tree = document.createElement('a-entity');
            let angle = (i / 16) * Math.PI * 2 + Math.random() * 0.3;
            let dist = 10 + Math.random() * 7;
            let x = Math.cos(angle) * dist;
            let z = Math.sin(angle) * dist;

            tree.setAttribute('position', `${x} 0 ${z}`);
            tree.classList.add('info-item');
            tree.setAttribute('data-name', treeNames[i % 8]);
            tree.setAttribute('data-desc', treeDescs[i % 8]);

            let trunk = document.createElement('a-cylinder');
            trunk.setAttribute('radius', 0.18); trunk.setAttribute('height', 1.8); trunk.setAttribute('color', '#8d6e63');
            trunk.setAttribute('position', '0 0.9 0');
            tree.appendChild(trunk);

            let leaves = document.createElement('a-icosahedron');
            leaves.setAttribute('radius', 1.4); 
            leaves.setAttribute('color', ['#ff9ff3', '#fd79a8', '#e84393'][i % 3]);
            leaves.setAttribute('position', '0 2.4 0');
            tree.appendChild(leaves);

            scene.appendChild(tree);
          }

          // Rocks, Fireflies, Birds, Stars — same as before but with info
          // (Abbreviated for clarity — full code below)

          // Rocks
          for (let i = 0; i < 12; i++) {
            let rock = document.createElement('a-dodecahedron');
            let angle = Math.random() * Math.PI * 2;
            let dist = 6 + Math.random() * 12;
            let x = Math.cos(angle) * dist;
            let z = Math.sin(angle) * dist;
            let scale = 0.7 + Math.random() * 1;
            rock.setAttribute('position', `${x} ${scale/2} ${z}`);
            rock.setAttribute('radius', scale);
            rock.setAttribute('color', '#636e72');
            rock.classList.add('info-item');
            rock.setAttribute('data-name', ['Zen Stone', 'Mossy Sage', 'Eternal Pebble'][i%3]);
            rock.setAttribute('data-desc', "Unmoved by time. Unbothered by drama.");
            scene.appendChild(rock);
          }

          // Fireflies
          for (let i = 0; i < 20; i++) {
            let fly = document.createElement('a-sphere');
            let angle = Math.random() * Math.PI * 2;
            let dist = 3 + Math.random() * 8;
            let x = Math.cos(angle) * dist;
            let z = Math.sin(angle) * dist;
            let y = 1.5 + Math.random() * 3;
            fly.setAttribute('position', `${x} ${y} ${z}`);
            fly.setAttribute('radius', 0.06);
            fly.setAttribute('color', '#fffaa8');
            fly.setAttribute('material', 'emissive: #fffaa8; emissiveIntensity: 1.2');
            fly.classList.add('info-item');
            fly.setAttribute('data-name', "Lantern Spirit");
            fly.setAttribute('data-desc', "Guides lost souls home. Also likes to party.");
            scene.appendChild(fly);
          }

          // Birds & Stars (same logic with info-item class)
          // ... (same as previous version)

          // Stars
          for (let i = 0; i < 250; i++) {
            let star = document.createElement('a-sphere');
            let theta = Math.random() * Math.PI * 2;
            let phi = Math.acos(2 * Math.random() - 1);
            let radius = 49;
            let x = radius * Math.sin(phi) * Math.cos(theta);
            let y = radius * Math.sin(phi) * Math.sin(theta) + 30;
            let z = radius * Math.cos(phi);
            star.setAttribute('position', `${x} ${y} ${z}`);
            star.setAttribute('radius', 0.2 + Math.random() * 0.15);
            star.setAttribute('material', 'emissive: white; opacity: 0');
            star.classList.add('night-star', 'info-item');
            star.setAttribute('data-name', "Ancient Light");
            star.setAttribute('data-desc', "Died billions of years ago. Still shining for you.");
            scene.appendChild(star);
          }
        }
      });

      // === DAY/NIGHT + AUTO TEXT COLOR ===
      AFRAME.registerComponent('atmosphere-control', {
        init: function () {
          this.isDay = true;
          this.sky = document.querySelector('a-sky');
          this.light = document.querySelector('#mainLight');
          this.sunMoon = this.el;
          this.sceneEl = document.querySelector('a-scene');
          this.panel = document.getElementById('info-panel');
          this.title = document.getElementById('info-title');
          this.text = document.getElementById('info-text');

          this.el.addEventListener('click', () => this.toggle());
        },
        toggle: function () {
          const birds = document.querySelectorAll('.day-birds');
          const stars = document.querySelectorAll('.night-star');

          if (this.isDay) {
            // To Night
            this.sky.setAttribute('color', '#0a1428');
            this.light.setAttribute('intensity', 0.03);
            this.sceneEl.setAttribute('fog', 'color: #0a1428; density: 0.05');
            birds.forEach(b => b.setAttribute('visible', false));
            stars.forEach(s => s.setAttribute('material', 'opacity', 1));
            this.sunMoon.setAttribute('color', '#f0f4f8');
            this.sunMoon.setAttribute('material', 'emissive: #dde4ff; emissiveIntensity: 0.9');
            this.sunMoon.setAttribute('light', 'type: point; intensity: 2.2; distance: 50');

            // Night text = white
            this.panel.classList.remove('day-text');
            this.panel.classList.add('night-text');
          } else {
            // To Day
            this.sky.setAttribute('color', '#81ecec');
            this.light.setAttribute('intensity', 1);
            this.sceneEl.setAttribute('fog', 'color: #e0f7fa; density: 0.04');
            birds.forEach(b => b.setAttribute('visible', true));
            stars.forEach(s => s.setAttribute('material', 'opacity', 0));
            this.sunMoon.setAttribute('color', '#ff7675');
            this.sunMoon.setAttribute('material', 'shader: flat');
            this.sunMoon.removeAttribute('light');

            // Day text = black
            this.panel.classList.remove('night-text');
            this.panel.classList.add('day-text');
          }
          this.isDay = !this.isDay;
        }
      });

      // === INFO PANEL ON GAZE (FIXED FOR TREES) ===
      const cursor = document.querySelector('a-cursor');
      const panel = document.getElementById('info-panel');
      const titleEl = document.getElementById('info-title');
      const textEl = document.getElementById('info-text');

      cursor.addEventListener('fusing', function (evt) {
        const target = evt.detail.intersectedEl;
        if (target && target.classList.contains('info-item')) {
          titleEl.textContent = target.getAttribute('data-name') || "Mystery";
          textEl.textContent = target.getAttribute('data-desc') || "It's vibing.";
          panel.classList.add('show');
        }
      });

      // Hide when not looking
      document.querySelector('a-scene').addEventListener('click', () => {
        setTimeout(() => {
          if (!cursor.components.cursor.intersectedEl?.classList.contains('info-item')) {
            panel.classList.remove('show');
          }
        }, 100);
      });
    </script>
  </body>
</html>